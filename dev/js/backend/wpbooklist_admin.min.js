/**
 * JavaScript Admin Functions - wpbooklist-admin.min.js
 *
 * @author   Jake Evans
 * @category JavaScript
 * @package  Includes/Assets/Js
 * @version  6.0.0
 */

console.log( 'This is the JavaScript Object that holds all PHP Variables for use in JavaScript' );
console.log( wpbooklistPhpVariables );


// All functions wrapped in jQuery(document).ready()...
jQuery( document ).ready( function( $ ) {
	'use strict';

	/* BEGINNING SECTION TO CALL ALL FUNCTIONS IN FILE... */

	// Makes the last active library the viewed library after page reload on the 'Edit & Delete Books' tab
	editLibReload();

	// Highlights the active tab
	wpbooklistHighlightActiveTab();

	// Only allow one localization checkbox to be checked.
	wpbooklistLocalCheckboxControl();

	/* ENDING SECTION TO CALL ALL FUNCTIONS IN FILE... */

	// Making the last active library the viewed library after page reload on the 'Edit & Delete Books' tab
	function editLibReload() {

		// Making the last active library the viewed library after page reload.
		if ( window.location.href.includes( 'library=' ) && window.location.href.includes( 'tab=edit-books' ) && window.location.href.includes( 'WPBookList' ) ) {
			$( '#wpbooklist-editbook-select-library' ).val( window.location.href.substr( window.location.href.lastIndexOf( '=' ) + 1 ) );
			$( '#wpbooklist-editbook-select-library' ).trigger( 'change' );
		}
	}

	function wpbooklistHighlightActiveTab() {

		// Highlight active tab
		if ( window.location.href.includes( '&tab=' ) ) {
			$( '.nav-tab' ).each( function() {
				if ( window.location.href == wpbooklistPhpVariables.FOR_TAB_HIGHLIGHT + $( this ).attr( 'href' ) ) {
					$( this ).first().css({'background-color': '#F05A1A', 'color': 'white'});
				}
			});
		} else {
			$( '.nav-tab' ).first().css({'background-color': '#F05A1A', 'color': 'white'});
		}
	}

	// Only allow one localization checkbox to be checked.
	function wpbooklistLocalCheckboxControl() {

		// Only allow one localization checkbox to be checked.
		$( '.wpbooklist-localization-checkbox' ).change( function() {
			$( '[name=us-based-book-info]' ).attr( 'checked', false );
			$( '[name=uk-based-book-info]' ).attr( 'checked', false );
			$( '[name=au-based-book-info]' ).attr( 'checked', false );
			$( '[name=br-based-book-info]' ).attr( 'checked', false );
			$( '[name=ca-based-book-info]' ).attr( 'checked', false );
			$( '[name=cn-based-book-info]' ).attr( 'checked', false );
			$( '[name=fr-based-book-info]' ).attr( 'checked', false );
			$( '[name=de-based-book-info]' ).attr( 'checked', false );
			$( '[name=in-based-book-info]' ).attr( 'checked', false );
			$( '[name=it-based-book-info]' ).attr( 'checked', false );
			$( '[name=jp-based-book-info]' ).attr( 'checked', false );
			$( '[name=mx-based-book-info]' ).attr( 'checked', false );
			$( '[name=es-based-book-info]' ).attr( 'checked', false );
			$( '[name=nl-based-book-info]' ).attr( 'checked', false );
			$( '[name=sg-based-book-info]' ).attr( 'checked', false );
			$( this ).attr( 'checked', true );
		});
	}

	// Handles the enabling/disabling of the 'Create a Library' button and input placeholder text
	function wpbooklistEnableDisableLibraryCreation() {

		// Handles the enabling/disabling of the 'Create a Library' button and input placeholder text
		$( '.wpbooklist-dynamic-input' ).on( 'click', function() {
			var currentVal = $( '.wpbooklist-dynamic-input' ).val();
			if ( 'Create a New Library Here...' == currentVal ) {
				$( '.wpbooklist-dynamic-input' ).val( '' );
			}
		});
		$( '.wpbooklist-dynamic-input' ).bind( 'input', function() {
			var currentVal = $( '.wpbooklist-dynamic-input' ).val();
			if ( ( 0 < currentVal.length ) && ( wpbooklistPhpVariables.adminjstransstring2 + '...' != currentVal ) ) {
				$( '#wpbooklist-dynamic-shortcode-button' ).attr( 'disabled', false );
			}
		});
	}
});
